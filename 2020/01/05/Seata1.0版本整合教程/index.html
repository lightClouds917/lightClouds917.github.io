<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>Seata 1.0版本整合SpringCloud教程 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="IT云清的博客">
  
  <meta name="description" content="seata 1.0入门教程技术选型及版本spring-cloud-starter-alibaba-seata spring-cloud-alibaba：1.5.1.RELEASE springcloud：Edgware.SR4 seata-all：1.0.0 springboot：1.5.4 mybatis-spring-boot-starter.version：2.0.0 java：jdk8 1">
<meta name="keywords" content="Java,Seata,SpringCloud">
<meta property="og:type" content="article">
<meta property="og:title" content="Seata 1.0版本整合SpringCloud教程">
<meta property="og:url" content="https://java4all.cn/2020/01/05/Seata1.0版本整合教程/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="seata 1.0入门教程技术选型及版本spring-cloud-starter-alibaba-seata spring-cloud-alibaba：1.5.1.RELEASE springcloud：Edgware.SR4 seata-all：1.0.0 springboot：1.5.4 mybatis-spring-boot-starter.version：2.0.0 java：jdk8 1">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-01-13T14:13:46.090Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Seata 1.0版本整合SpringCloud教程">
<meta name="twitter:description" content="seata 1.0入门教程技术选型及版本spring-cloud-starter-alibaba-seata spring-cloud-alibaba：1.5.1.RELEASE springcloud：Edgware.SR4 seata-all：1.0.0 springboot：1.5.4 mybatis-spring-boot-starter.version：2.0.0 java：jdk8 1">
  
  
    <link rel="icon" href="/my.icon">
  
  <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>
  

  
  

</head>
</html>
<body>
  <div id="container">
      <header id="header">
    <div id="banner"></div>
    <div id="header-outer">
        <div id="header-menu" class="header-menu-pos animated">
            <div class="header-menu-container">
                <a href="/" class="left">
                    <span class="site-title">IT云清</span>
                </a>
                <nav id="header-menu-nav" class="right">
                    
                    <a  href="/">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </a>
                    
                    <a  href="/archives">
                        <i class="fa fa-archive"></i>
                        <span>Archives</span>
                    </a>
                    
                    <a  href="/about">
                        <i class="fa fa-user"></i>
                        <span>About</span>
                    </a>
                    
                </nav>
                <a class="mobile-header-menu-button">
                    <i class="fa fa-bars"></i>
                </a>
            </div>
        </div>
        <div id="header-row">
            <div id="logo">
                <a href="/">
                    <img src="/images/logo3.jpg" alt="logo">
                </a>
            </div>
            <div class="header-info">
                <div id="header-title">
                    
                    <h2>
                        IT云清
                    </h2>
                    
                </div>
                <div id="header-description">
                    
                    <h3>
                        专注于JAVA
                    </h3>
                    
                </div>
            </div>
            <nav class="header-nav">
                <div class="social">
                    
                        <a title="IT云清" target="_blank" href="//java4all.cn">
                            <i class="fa fa-home fa-2x"></i></a>
                    
                        <a title="Github" target="_blank" href="//github.com/lightClouds917">
                            <i class="fa fa-github fa-2x"></i></a>
                    
                        <a title="CSDN" target="_blank" href="//it4all.blog.csdn.net">
                            <i class="fa fa-twitter fa-2x"></i></a>
                    
                        <a title="w1186355422"  ">
                            <i class="fa fa-weixin fa-2x"></i></a>
                    
                </div>
            </nav>
        </div>
    </div>
</header>
      <div class="outer">
        <section id="main" class="body-wrap"><article id="post-Seata1.0版本整合教程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="post-title" itemprop="name">
      Seata 1.0版本整合SpringCloud教程
    </h1>
    <div class="post-title-bar">
      <ul>
          
              <li>
                  <i class="fa fa-book"></i>
                  
                      <a href="/categories/Seata/">Seata</a>
                  
              </li>
          
        <li>
          <i class="fa fa-calendar"></i>  2020-01-05
        </li>
        <li>
          <i class="fa fa-eye"></i>
          <span id="busuanzi_value_page_pv"></span>
        </li>
      </ul>
    </div>
  

          
      </header>
    
    <div class="article-entry post-content" itemprop="articleBody">
      
            
            <h1 id="seata-1-0入门教程"><a href="#seata-1-0入门教程" class="headerlink" title="seata 1.0入门教程"></a>seata 1.0入门教程</h1><h3 id="技术选型及版本"><a href="#技术选型及版本" class="headerlink" title="技术选型及版本"></a>技术选型及版本</h3><p>spring-cloud-starter-alibaba-seata</p>
<p>spring-cloud-alibaba：1.5.1.RELEASE</p>
<p>springcloud：Edgware.SR4</p>
<p>seata-all：1.0.0</p>
<p>springboot：1.5.4</p>
<p>mybatis-spring-boot-starter.version：2.0.0</p>
<p>java：jdk8</p>
<h3 id="1-启动seata-server"><a href="#1-启动seata-server" class="headerlink" title="1.启动seata server"></a>1.启动seata server</h3><p>下载包：<a href="https://github.com/seata/seata/releases" target="_blank" rel="noopener">https://github.com/seata/seata/releases</a></p>
<p>解压：tar -xzvf seata-server-1.0.0.tar.gz</p>
<p>修改配置：</p>
<h4 id="1-配置registry-conf"><a href="#1-配置registry-conf" class="headerlink" title="1.配置registry.conf"></a>1.配置registry.conf</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@jr-test conf]# cat registry.conf </span><br><span class="line"><span class="comment">//注册中心</span></span><br><span class="line">registry &#123;</span><br><span class="line">  # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span><br><span class="line">  type = <span class="string">"eureka"</span> <span class="comment">//注册中心类型</span></span><br><span class="line"></span><br><span class="line">  nacos &#123;</span><br><span class="line">    serverAddr = <span class="string">"localhost"</span></span><br><span class="line">    namespace = <span class="string">""</span></span><br><span class="line">    cluster = <span class="string">"default"</span></span><br><span class="line">  &#125;</span><br><span class="line">  eureka &#123;</span><br><span class="line">    serviceUrl = <span class="string">"http://192.xx.xx.xx:8761/eureka"</span> <span class="comment">//注册中心地址</span></span><br><span class="line">    application = <span class="string">"fsp_tx"</span> <span class="comment">//tc注册时的名称</span></span><br><span class="line">    weight = <span class="string">"1"</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//......支持多种</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//配置中心</span></span><br><span class="line">config &#123;</span><br><span class="line">  # file、nacos 、apollo、zk、consul、etcd3</span><br><span class="line">  type = <span class="string">"file"</span> <span class="comment">//配置中心类型</span></span><br><span class="line">  file &#123;</span><br><span class="line">    name = <span class="string">"file.conf"</span> <span class="comment">//</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//......支持多种</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-配置file-conf"><a href="#2-配置file-conf" class="headerlink" title="2.配置file.conf"></a>2.配置file.conf</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@jr-test conf]# cat file.conf</span><br><span class="line">service &#123;</span><br><span class="line">  #transaction service group mapping</span><br><span class="line">  vgroup_mapping.<span class="keyword">default</span> = <span class="string">"fsp_tx"</span>  <span class="comment">//事务分组，非常重要，client和tc一定要一致，default是个自定义的分组名称</span></span><br><span class="line">  #only support when registry.type=file, please don't set multiple addresses</span><br><span class="line">  <span class="keyword">default</span>.grouplist = <span class="string">"127.0.0.1:8091"</span></span><br><span class="line">  #disable seata</span><br><span class="line">  disableGlobalTransaction = <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">## transaction log store, only used in seata-server</span><br><span class="line">store &#123;</span><br><span class="line">  ## store mode: file、db</span><br><span class="line">  mode = <span class="string">"db"</span> <span class="comment">//事务日志存储模式</span></span><br><span class="line"></span><br><span class="line">  ## file store property</span><br><span class="line">  file &#123;</span><br><span class="line">    ## store location dir</span><br><span class="line">    dir = <span class="string">"sessionStore"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ## database store property</span><br><span class="line">  db &#123;</span><br><span class="line">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc.</span><br><span class="line">    datasource = <span class="string">"dbcp"</span></span><br><span class="line">    ## mysql/oracle/h2/oceanbase etc.</span><br><span class="line">    db-type = <span class="string">"mysql"</span></span><br><span class="line">    driver-<span class="class"><span class="keyword">class</span>-<span class="title">name</span> </span>= <span class="string">"com.mysql.jdbc.Driver"</span></span><br><span class="line">    url = <span class="string">"jdbc:mysql://192.xx.xx.xx:3306/seata"</span> <span class="comment">// tc的数据库,可自定义命名，对应就好</span></span><br><span class="line">    user = <span class="string">"root"</span></span><br><span class="line">    password = <span class="string">"xxx"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-建表"><a href="#3-建表" class="headerlink" title="3.建表"></a>3.建表</h4><p>全局事务会话信息由3块内容构成：</p>
<ul>
<li>全局事务 global_table</li>
<li>分支事务 branch_table</li>
<li>全局锁  lock_table </li>
</ul>
<p>建表语句在：<a href="https://github.com/seata/seata/tree/develop/script/server/db" target="_blank" rel="noopener">https://github.com/seata/seata/tree/develop/script/server/db</a></p>
<h4 id="4-启动tc"><a href="#4-启动tc" class="headerlink" title="4.启动tc"></a>4.启动tc</h4><p>bin目录下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup sh seata-server.sh -h xx.xx.xx.xx -p <span class="number">8091</span> -m db -n <span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure>

<p>这里是以nohup的方式后台启动，参数可选：</p>
<p>-h: 注册到注册中心的ip</p>
<p> -p: Server rpc 监听端口 </p>
<p>-m: 全局事务会话信息存储模式，file、db，优先读取启动参数 </p>
<p>-n: Server node，多个Server时，需区分各自节点，用于生成不同区间的transactionId，以免冲突 </p>
<p>-e: 多环境配置参考 <a href="http://seata.io/en-us/docs/ops/multi-configuration-isolation.html" target="_blank" rel="noopener">http://seata.io/en-us/docs/ops/multi-configuration-isolation.html</a> </p>
<h3 id="2-client端引入seata依赖"><a href="#2-client端引入seata依赖" class="headerlink" title="2.client端引入seata依赖"></a>2.client端引入seata依赖</h3><p>目前有三种方式，相应的支持程度不同：</p>
<table>
<thead>
<tr>
<th>依赖</th>
<th>支持yml配置</th>
<th>实现xid传递</th>
<th>支持数据源自动代理</th>
<th>自动初始化GlobalTransactionScanner入口</th>
</tr>
</thead>
<tbody><tr>
<td>seata-all</td>
<td>否</td>
<td>否</td>
<td>是</td>
<td>否</td>
</tr>
<tr>
<td>seata-spring-boot-starter</td>
<td>是</td>
<td>否</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>spring-cloud-alibaba-seata</td>
<td>否</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
</tbody></table>
<p>不建议用户仅引入seata-all，需要自行实现的东西太多。</p>
<p>spring-cloud-alibaba-seata，2.1.0内嵌seata-all 0.7.1，2.1.1内嵌seata-all 0.9.0。建议排除掉，引入1.0；</p>
<p>我们这里以引入spring-cloud-alibaba-seata 依赖为例，下面仅展示与seata相关的依赖：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">	&lt;spring-cloud.version&gt;Edgware.SR4&lt;/spring-cloud.version&gt;</span><br><span class="line">	&lt;spring-cloud-alibaba.version&gt;1.5.1.RELEASE&lt;/spring-cloud-alibaba.version&gt;</span><br><span class="line">	&lt;seata-version&gt;1.0.0&lt;/seata-version&gt;</span><br><span class="line">&lt;/properties&gt;</span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">	&lt;!--seata-all--&gt;</span><br><span class="line">	&lt;dependency&gt;</span><br><span class="line">		&lt;groupId&gt;io.seata&lt;/groupId&gt;</span><br><span class="line">		&lt;artifactId&gt;seata-all&lt;/artifactId&gt;</span><br><span class="line">		&lt;version&gt;$&#123;seata-version&#125;&lt;/version&gt;</span><br><span class="line">	&lt;/dependency&gt;</span><br><span class="line">	&lt;!--sca-seata--&gt;</span><br><span class="line">	&lt;dependency&gt;</span><br><span class="line">		&lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">		&lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt;</span><br><span class="line">	&lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">	&lt;dependencies&gt;</span><br><span class="line">		&lt;!--Spring Cloud--&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt;</span><br><span class="line">			&lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">			&lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;!--Spring Cloud Alibaba，包含seata-all <span class="number">0.9</span>,这里排除掉，换为<span class="number">1.0</span>--&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">			&lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">			&lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;</span><br><span class="line">			&lt;version&gt;$&#123;spring-cloud-alibaba.version&#125;&lt;/version&gt;</span><br><span class="line">			&lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">			&lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">			&lt;exclusions&gt;</span><br><span class="line">				&lt;exclusion&gt;</span><br><span class="line">					&lt;artifactId&gt;seata-all&lt;/artifactId&gt;</span><br><span class="line">					&lt;groupId&gt;io.seata&lt;/groupId&gt;</span><br><span class="line">				&lt;/exclusion&gt;</span><br><span class="line">			&lt;/exclusions&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">	&lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-client端引入配置文件"><a href="#3-client端引入配置文件" class="headerlink" title="3.client端引入配置文件"></a>3.client端引入配置文件</h3><p>seata server端和client端的脚本和配置，都汇总在这里，client端整合时，去找对应的文件复制过来修改。</p>
<p><a href="https://github.com/seata/seata/tree/develop/script" target="_blank" rel="noopener">https://github.com/seata/seata/tree/develop/script</a></p>
<h4 id="1-修改bootstrap-yml"><a href="#1-修改bootstrap-yml" class="headerlink" title="1.修改bootstrap.yml"></a>1.修改bootstrap.yml</h4><p>添加事务分组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  cloud:</span><br><span class="line">    alibaba:</span><br><span class="line">      seata:</span><br><span class="line">        tx-service-group: <span class="keyword">default</span> <span class="comment">//这个default是事务分组名称，与server端的事务分组名称保持一致</span></span><br></pre></td></tr></table></figure>

<p>这个分组名称自定义，但是seata server端，client端要保持一致。</p>
<h4 id="2-配置file-conf-1"><a href="#2-配置file-conf-1" class="headerlink" title="2.配置file.conf"></a>2.配置file.conf</h4><p>引入配置文件，并修改相关配置，由于有很多配置项，不是每个都需要去改一遍，这里只是改动少数，让你先能整合进去跑起来，其他的参数后面再自己调整。</p>
<p>file.conf</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//省略很多</span></span><br><span class="line">service &#123;</span><br><span class="line">  #transaction service group mapping</span><br><span class="line">  vgroup_mapping.<span class="keyword">default</span> = <span class="string">"fsp_tx"</span>  <span class="comment">//这个default是事务分组名称，与server端的事务分组名称保持一致</span></span><br><span class="line">  #only support when registry.type=file, please don't set multiple addresses</span><br><span class="line">  <span class="keyword">default</span>.grouplist = <span class="string">"127.0.0.1:8091"</span></span><br><span class="line">  #degrade, current not support</span><br><span class="line">  enableDegrade = <span class="keyword">false</span></span><br><span class="line">  #disable seata</span><br><span class="line">  disableGlobalTransaction = <span class="keyword">false</span></span><br><span class="line">&#125;</span><br><span class="line">client &#123;</span><br><span class="line">    <span class="comment">//省略很多</span></span><br><span class="line">  rm &#123;</span><br><span class="line">    report.success.enable = <span class="keyword">true</span> <span class="comment">//一阶段成功后是否上报tc，这个配置可以提高性能</span></span><br><span class="line">  &#125;</span><br><span class="line">  support &#123;</span><br><span class="line">    # auto proxy the DataSource bean //数据源自动代理</span><br><span class="line">    spring.datasource.autoproxy = <span class="keyword">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-配置registry-conf"><a href="#3-配置registry-conf" class="headerlink" title="3.配置registry.conf"></a>3.配置registry.conf</h4><p>注册中心和配置中心，都支持多种，按照自己的技术选型，修改对应的配置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">registry &#123;</span><br><span class="line">  # file 、nacos 、eureka、redis、zk</span><br><span class="line">  type = <span class="string">"eureka"</span></span><br><span class="line">  eureka &#123;</span><br><span class="line">    serviceUrl = <span class="string">"http://192.xx.xx.xx:8761/eureka"</span></span><br><span class="line">    application = <span class="string">"fsp_tx"</span> </span><br><span class="line">    weight = <span class="string">"1"</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//省略</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">config &#123;</span><br><span class="line">  # file、nacos 、apollo、zk</span><br><span class="line">  type = <span class="string">"file"</span></span><br><span class="line">  file &#123;</span><br><span class="line">    name = <span class="string">"file.conf"</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//省略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-配置数据源头代理"><a href="#4-配置数据源头代理" class="headerlink" title="4.配置数据源头代理"></a>4.配置数据源头代理</h3><p>如果支持自动代理，那就开启配置就好，这里示例下使用mysql和mybatis时，如何自行代理数据源。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.seata.sample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> io.seata.rm.datasource.DataSourceProxy;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.transaction.SpringManagedTransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Primary;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 数据源代理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> IT云清</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">druidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        DruidDataSource druidDataSource = <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">        <span class="keyword">return</span> druidDataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"dataSource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceProxy <span class="title">dataSource</span><span class="params">(DataSource druidDataSource)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProxy(druidDataSource);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">sqlSessionFactory</span><span class="params">(DataSourceProxy dataSourceProxy)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSourceProxy);</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(<span class="keyword">new</span> PathMatchingResourcePatternResolver()</span><br><span class="line">                .getResources(<span class="string">"classpath*:/mapper/*.xml"</span>));</span><br><span class="line">        sqlSessionFactoryBean.setTransactionFactory(<span class="keyword">new</span> SpringManagedTransactionFactory());</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean.getObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-实现xid传递"><a href="#5-实现xid传递" class="headerlink" title="5.实现xid传递"></a>5.实现xid传递</h3><p>如果你引入的依赖和技术选型，没有实现xid传递等逻辑，你需要参考源码integration文件夹下的各种rpc实现 module。</p>
<p><a href="https://github.com/seata/seata/tree/develop/integration" target="_blank" rel="noopener">https://github.com/seata/seata/tree/develop/integration</a></p>
<h3 id="6-实现scanner入口"><a href="#6-实现scanner入口" class="headerlink" title="6.实现scanner入口"></a>6.实现scanner入口</h3><p>如果你引入的依赖和技术选型，没有实现初始化GlobalTransactionScanner逻辑，可以自行实现如下：</p>
<p>1.SeataProperties.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(<span class="string">"spring.cloud.alibaba.seata"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SeataProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String txServiceGroup;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SeataProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTxServiceGroup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.txServiceGroup;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTxServiceGroup</span><span class="params">(String txServiceGroup)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.txServiceGroup = txServiceGroup;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.初始化GlobalTransactionScanner</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.runlion.fsp.credit.seata.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.runlion.fsp.credit.seata.SeataProperties;</span><br><span class="line"><span class="keyword">import</span> io.seata.spring.annotation.GlobalTransactionScanner;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.EnableConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> IT云清</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties</span>(&#123;SeataProperties.class&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalTransactionAutoConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String APPLICATION_NAME_PREFIX = <span class="string">"spring.application.name"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_TX_SERVICE_GROUP_SUFFIX = <span class="string">"-seata-service-group"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ApplicationContext applicationContext;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SeataProperties seataProperties;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GlobalTransactionAutoConfiguration</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            ApplicationContext applicationContext,</span></span></span><br><span class="line"><span class="function"><span class="params">            SeataProperties seataProperties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">        <span class="keyword">this</span>.seataProperties = seataProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * If there is no txServiceGroup,use the default</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> GlobalTransactionScanner the entrance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> GlobalTransactionScanner <span class="title">globalTransactionScanner</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String applicationName = <span class="keyword">this</span>.applicationContext.getEnvironment().getProperty(APPLICATION_NAME_PREFIX);</span><br><span class="line">        String txServiceGroup = seataProperties.getTxServiceGroup();</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(txServiceGroup))&#123;</span><br><span class="line">            txServiceGroup = applicationName + DEFAULT_TX_SERVICE_GROUP_SUFFIX;</span><br><span class="line">            <span class="keyword">this</span>.seataProperties.setTxServiceGroup(txServiceGroup);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> GlobalTransactionScanner(applicationName,txServiceGroup);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-建表"><a href="#7-建表" class="headerlink" title="7.建表"></a>7.建表</h3><p>如果要使用seata分布式事务，当前服务就需要建一张undolog表。</p>
<p>建表语句参考：<a href="https://github.com/seata/seata/tree/develop/script/client/at/db" target="_blank" rel="noopener">https://github.com/seata/seata/tree/develop/script/client/at/db</a></p>
<h3 id="8-使用"><a href="#8-使用" class="headerlink" title="8.使用"></a>8.使用</h3><ul>
<li>1.@GlobalTransaction 全局事务注解</li>
<li>2.@GlobalLock 防止脏读和脏写，又不想纳入全局事务管理时使用。（不需要rpc和xid传递等成本）</li>
</ul>
<h3 id="9-辅助信息"><a href="#9-辅助信息" class="headerlink" title="9.辅助信息"></a>9.辅助信息</h3><h5 id="如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully-begin-global-transaction，Successfully-register-branch-xid-。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。"><a href="#如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully-begin-global-transaction，Successfully-register-branch-xid-。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。" class="headerlink" title="如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully begin global transaction，Successfully register branch xid = 。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。"></a>如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully begin global transaction，Successfully register branch xid = 。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。</h5><h4 id="1-client端如果正常启动，在server端会有如下日志，否则，请再检查配置："><a href="#1-client端如果正常启动，在server端会有如下日志，否则，请再检查配置：" class="headerlink" title="1.client端如果正常启动，在server端会有如下日志，否则，请再检查配置："></a>1.client端如果正常启动，在server端会有如下日志，否则，请再检查配置：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">15</span>:<span class="number">38</span>:<span class="number">44.170</span> INFO [ServerHandlerThread_1_500]io.seata.core.rpc.DefaultServerMessageListenerImpl.onRegRmMessage:<span class="number">123</span> -rm register success,message:RegisterRMRequest&#123;resourceIds=<span class="string">'jdbc:mysql://116.xx.xx.xx/seata-account'</span>, applicationId=<span class="string">'account-server'</span>, transactionServiceGroup=<span class="string">'default'</span>&#125;,channel:[id: <span class="number">0xb58488ac</span>, L:/<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span> - R:/<span class="number">192</span>.xx.xx.xx:<span class="number">13641</span>]</span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">15</span>:<span class="number">38</span>:<span class="number">44.968</span> INFO [NettyServerNIOWorker_1_8]io.seata.core.rpc.DefaultServerMessageListenerImpl.onRegTmMessage:<span class="number">140</span> -checkAuth <span class="keyword">for</span> client:<span class="number">192</span>.xx.xx.xx:<span class="number">13644</span>,vgroup:<span class="keyword">default</span>,applicationId:account-server</span><br></pre></td></tr></table></figure>

<h4 id="2-全局事务提交成功-server端会有日志如下："><a href="#2-全局事务提交成功-server端会有日志如下：" class="headerlink" title="2.全局事务提交成功,server端会有日志如下："></a>2.全局事务提交成功,server端会有日志如下：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.209</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage timeout=<span class="number">60000</span>,transactionName=fsp-create-order</span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.211</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.begin:<span class="number">154</span> -Successfully begin global transaction xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.253</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchType=AT,resourceId=jdbc:mysql:<span class="comment">//116.62.62.26/seata-order,lockKey=order:877</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.257</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.lambda$branchRegister$<span class="number">0</span>:<span class="number">98</span> -Successfully register branch xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075694</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.278</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchId=<span class="number">2031075694</span>,resourceId=<span class="keyword">null</span>,status=PhaseOne_Done,applicationData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.283</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.branchReport:<span class="number">126</span> -Successfully branch report xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075694</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.339</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchType=AT,resourceId=jdbc:mysql:<span class="comment">//116.62.62.26/seata-storage,lockKey=storage:1</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.344</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.lambda$branchRegister$<span class="number">0</span>:<span class="number">98</span> -Successfully register branch xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075697</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.363</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchId=<span class="number">2031075697</span>,resourceId=<span class="keyword">null</span>,status=PhaseOne_Done,applicationData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">31.366</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.branchReport:<span class="number">126</span> -Successfully branch report xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075697</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.237</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchType=AT,resourceId=jdbc:mysql:<span class="comment">//116.62.62.26/seata-account,lockKey=account:1</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.242</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.lambda$branchRegister$<span class="number">0</span>:<span class="number">98</span> -Successfully register branch xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075701</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.294</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,branchId=<span class="number">2031075701</span>,resourceId=<span class="keyword">null</span>,status=PhaseOne_Done,applicationData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.327</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.branchReport:<span class="number">126</span> -Successfully branch report xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>, branchId = <span class="number">2031075701</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.368</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>,extraData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">00</span>:<span class="number">32.775</span> INFO [AsyncCommitting_1]io.seata.server.coordinator.DefaultCore.doGlobalCommit:<span class="number">316</span> -Global[<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075692</span>] committing is successfully done.</span><br></pre></td></tr></table></figure>

<h4 id="3-全局事务提交失败-server端会有日志如下："><a href="#3-全局事务提交失败-server端会有日志如下：" class="headerlink" title="3.全局事务提交失败,server端会有日志如下："></a>3.全局事务提交失败,server端会有日志如下：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.327</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage timeout=<span class="number">60000</span>,transactionName=fsp-create-order</span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.329</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.begin:<span class="number">154</span> -Successfully begin global transaction xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.408</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>,branchType=AT,resourceId=jdbc:mysql:<span class="comment">//116.62.62.26/seata-order,lockKey=order:878</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.412</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.lambda$branchRegister$<span class="number">0</span>:<span class="number">98</span> -Successfully register branch xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>, branchId = <span class="number">2031075711</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.432</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>,branchId=<span class="number">2031075711</span>,resourceId=<span class="keyword">null</span>,status=PhaseOne_Done,applicationData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.435</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.branchReport:<span class="number">126</span> -Successfully branch report xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>, branchId = <span class="number">2031075711</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.520</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>,branchType=AT,resourceId=jdbc:mysql:<span class="comment">//116.62.62.26/seata-storage,lockKey=storage:1</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.523</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.lambda$branchRegister$<span class="number">0</span>:<span class="number">98</span> -Successfully register branch xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>, branchId = <span class="number">2031075714</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.541</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>,branchId=<span class="number">2031075714</span>,resourceId=<span class="keyword">null</span>,status=PhaseOne_Done,applicationData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">50.544</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.branchReport:<span class="number">126</span> -Successfully branch report xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>, branchId = <span class="number">2031075714</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">52.569</span> INFO [batchLoggerPrint_1]io.seata.core.rpc.DefaultServerMessageListenerImpl.run:<span class="number">205</span> -SeataMergeMessage xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span>,extraData=<span class="keyword">null</span></span><br><span class="line">,clientIp:<span class="number">192</span>.xx.xx.xx,vgroup:<span class="keyword">default</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">52.626</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.doGlobalRollback:<span class="number">418</span> -Successfully rollback branch xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span> branchId=<span class="number">2031075714</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">52.693</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.doGlobalRollback:<span class="number">418</span> -Successfully rollback branch xid=<span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span> branchId=<span class="number">2031075711</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">12</span>-<span class="number">31</span> <span class="number">16</span>:<span class="number">16</span>:<span class="number">52.696</span> INFO [ServerHandlerThread_1_500]io.seata.server.coordinator.DefaultCore.doGlobalRollback:<span class="number">465</span> -Successfully rollback global, xid = <span class="number">192</span>.xx.xx.xx:<span class="number">8091</span>:<span class="number">2031075709</span></span><br></pre></td></tr></table></figure>


            <div class="post-copyright">
    <div class="content">
        <p>最后更新： 2020年01月13日 22:13</p>
        <p>原始链接： <a class="post-url" href="/2020/01/05/Seata1.0版本整合教程/" title="Seata 1.0版本整合SpringCloud教程">https://java4all.cn/2020/01/05/Seata1.0版本整合教程/</a></p>
        <footer>
            <a href="https://java4all.cn">
                <img src="/images/logo3.jpg" alt="IT云清">
                IT云清
            </a>
        </footer>
    </div>
</div>

      
        
            

        
    </div>
    <footer class="article-footer">
        
        
<div class="post-share">
    <a href="javascript:;" id="share-sub" class="post-share-fab">
        <i class="fa fa-share-alt"></i>
    </a>
    <div class="post-share-list" id="share-list">
        <ul class="share-icons">
          <li>
            <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/&title=《Seata 1.0版本整合SpringCloud教程》 — Hexo&pic=https://java4all.cn/images/logo2.jpg" data-title="微博">
              <i class="fa fa-weibo"></i>
            </a>
          </li>
          <li>
            <a class="weixin share-sns" id="wxFab" href="javascript:;" data-title="微信">
              <i class="fa fa-weixin"></i>
            </a>
          </li>
          <li>
            <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/&title=《Seata 1.0版本整合SpringCloud教程》 — Hexo&source=" data-title="QQ">
              <i class="fa fa-qq"></i>
            </a>
          </li>
          <li>
            <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/" data-title="Facebook">
              <i class="fa fa-facebook"></i>
            </a>
          </li>
          <li>
            <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Seata 1.0版本整合SpringCloud教程》 — Hexo&url=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/&via=https://java4all.cn" data-title="Twitter">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li>
            <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/" data-title="Google+">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        </ul>
     </div>
</div>
<div class="post-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" id="wxShare-close">×</a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://java4all.cn/2020/01/05/Seata1.0版本整合教程/" alt="微信分享二维码">
</div>

<div class="mask"></div>

        
        <ul class="article-footer-menu">
            
            
  <li class="article-footer-tags">
    <i class="fa fa-tags"></i>
      
    <a href="/tags/Java/" class="color5">Java</a>
      
    <a href="/tags/Seata/" class="color1">Seata</a>
      
    <a href="/tags/SpringCloud/" class="color2">SpringCloud</a>
      
  </li>

        </ul>
        
    </footer>
  </div>
</article>


    <aside class="post-toc-pos post-toc-top" id="post-toc">
        <nav class="post-toc-wrap">
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#seata-1-0入门教程"><span class="post-toc-text">seata 1.0入门教程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#技术选型及版本"><span class="post-toc-text">技术选型及版本</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-启动seata-server"><span class="post-toc-text">1.启动seata server</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-配置registry-conf"><span class="post-toc-text">1.配置registry.conf</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-配置file-conf"><span class="post-toc-text">2.配置file.conf</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-建表"><span class="post-toc-text">3.建表</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-启动tc"><span class="post-toc-text">4.启动tc</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-client端引入seata依赖"><span class="post-toc-text">2.client端引入seata依赖</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-client端引入配置文件"><span class="post-toc-text">3.client端引入配置文件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-修改bootstrap-yml"><span class="post-toc-text">1.修改bootstrap.yml</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-配置file-conf-1"><span class="post-toc-text">2.配置file.conf</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-配置registry-conf"><span class="post-toc-text">3.配置registry.conf</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-配置数据源头代理"><span class="post-toc-text">4.配置数据源头代理</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-实现xid传递"><span class="post-toc-text">5.实现xid传递</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#6-实现scanner入口"><span class="post-toc-text">6.实现scanner入口</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#7-建表"><span class="post-toc-text">7.建表</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#8-使用"><span class="post-toc-text">8.使用</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#9-辅助信息"><span class="post-toc-text">9.辅助信息</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully-begin-global-transaction，Successfully-register-branch-xid-。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。"><span class="post-toc-text">如果发现数据不一致，可以参考下面的一些典型日志，或者查找关键字，比如Successfully begin global transaction，Successfully register branch xid = 。。。可以辅助你确认你的配置是否正确有效，各分支事务是否注册，纳入全局管理。</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-client端如果正常启动，在server端会有如下日志，否则，请再检查配置："><span class="post-toc-text">1.client端如果正常启动，在server端会有如下日志，否则，请再检查配置：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-全局事务提交成功-server端会有日志如下："><span class="post-toc-text">2.全局事务提交成功,server端会有日志如下：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-全局事务提交失败-server端会有日志如下："><span class="post-toc-text">3.全局事务提交失败,server端会有日志如下：</span></a></li></ol></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    

<nav id="article-nav">
  
    <a href="/2020/01/05/2019代码评审总结/" id="article-nav-newer" class="article-nav-link-wrap">

      <span class="article-nav-title">
        <i class="fa fa-hand-o-left" aria-hidden="true"></i>
        
          code review问题总结
        
      </span>
    </a>
  
  
</nav>



    
</section>
        
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        今日访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        今日访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


      <p>
        Powered by  <a href="http://hexo.io/" target="_blank">Hexo</a>
        Theme <a href="//github.com/wongminho/hexo-theme-miho" target="_blank">MiHo</a>
      &copy; 2020 IT云清<br>
      </p>
    </div>
  </div>
</footer>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script>
  var mihoConfig = {
      root: "https://java4all.cn",
      animate: true,
      isHome: false,
      share: true,
      reward: 0
  }
</script>
<div class="sidebar">
    <div id="sidebar-search" title="Search">
        <i class="fa fa-search"></i>
    </div>
    <div id="sidebar-category" title="Categories">
        <i class="fa fa-book"></i>
    </div>
    <div id="sidebar-tag" title="Tags">
        <i class="fa fa-tags"></i>
    </div>
    <div id="sidebar-top">
        <span class="sidebar-top-icon"><i class="fa fa-angle-up"></i></span>
    </div>
</div>
<div class="sidebar-menu-box" id="sidebar-menu-box">
    <div class="sidebar-menu-box-container">
        <div id="sidebar-menu-box-categories">
            <a class="category-link" href="/categories/Seata/">Seata</a><a class="category-link" href="/categories/管理/">管理</a>
        </div>
        <div id="sidebar-menu-box-tags">
            <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Seata/" style="font-size: 10px;">Seata</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/code-review/" style="font-size: 10px;">code review</a> <a href="/tags/管理/" style="font-size: 10px;">管理</a>
        </div>
    </div>
    <a href="javascript:;" class="sidebar-menu-box-close">&times;</a>
</div>
<div class="mobile-header-menu-nav" id="mobile-header-menu-nav">
    <div class="mobile-header-menu-container">
        <span class="title">Menus</span>
        <ul class="mobile-header-menu-navbar">
            
            <li>
                <a  href="/">
                    <i class="fa fa-home"></i><span>Home</span>
                </a>
            </li>
            
            <li>
                <a  href="/archives">
                    <i class="fa fa-archive"></i><span>Archives</span>
                </a>
            </li>
            
            <li>
                <a  href="/about">
                    <i class="fa fa-user"></i><span>About</span>
                </a>
            </li>
            
        </ul>
    </div>
    <div class="mobile-header-tag-container">
        <span class="title">Tags</span>
        <div id="mobile-header-container-tags">
            <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Seata/" style="font-size: 10px;">Seata</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/code-review/" style="font-size: 10px;">code review</a> <a href="/tags/管理/" style="font-size: 10px;">管理</a>
        </div>
    </div>
</div>
<div class="search-wrap">
    <span class="search-close">&times;</span>
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
            <i class="icon icon-lg icon-chevron-left"></i>
        </a>
        <input class="search-field" placeholder="Search..." id="keywords">
        <a id="search-submit" href="javascript:;">
            <i class="fa fa-search"></i>
        </a>
    <div class="search-container" id="search-container">
        <ul class="search-result" id="search-result">
        </ul>
    </div>
</div>

<div id="search-tpl">
    <li class="search-result-item">
        <a href="{url}" class="search-item-li">
            <span class="search-item-li-title" title="{title}">{title}</span>
        </a>
    </li>
</div>
<script src="/js/search.js"></script>
<script src="/js/main.js"></script>


  <script src="//cdn.bootcss.com/particles.js/2.0.0/particles.min.js"></script>
  <div id="particles"></div>
  <script src="/js/particles.js"></script>







  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  <script src="//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js"></script>
  <script src="/js/animate.js"></script>


  <script src="/js/pop-img.js"></script>
  <script>
     $(".article-entry p img").popImg();
  </script>

  </div>
</body>
</html>